#include <seqan/sequence.h>
#include <seqan/index.h>

using namespace seqan;

int main()
{
	String<AminoAcid> protein = "MRKDADMAIFGEAAPYLRKSEKERIEAQNKPFDAKSSVFVADPKESFVKATVQSREGGKVTAKTEAGATVTVKEDQVFPMNPPKYDKIEDMAMMTHLHEPAVLYNLKEXYAAWMIYTYSGLFCVTVNPYKWLPVYNAEVVTAYRGKKRQEAPPHIFSISDNAYQFMLTDRENQSILITGESGAGKTVNTKRVIQYFATIAVTGDKKKEEATSGKMQGTLEDQIISANPLLEAFANAKTVRNDNSSRFGKFIRIHFGTTGKLASADIETYLLEKSRVTFQLKAERSYHIFYQIMSNKKPDLIEMLLITTNPYDYAFVSQGEITVPSIDDQEELMATDSAIDILGFTSDERVSIYKLTGAVMHYGNMKFKQKQREEQAEPDGTEVADKAAYLQSLNSXDLLKALCYPRVKVGNEYVTKGQTVQQVYNAVGALAKAVYEKMFLWMVTRINQQLDTKQPRQYFIGVLDIAGFEIFDFNSLEQLCINFTNEKLQQFFNHHMFVLEQEEYKKEGIEWEFIDFGMDLAACIELIEKPMGIFSILEEECMFPKATDTSFKNKLYEQHLGKSNNFQKPKPAKRKVEAHFSLVHYAGTVDYNITGWLDKNKDPLNETVVGLYQKSAMKTLAFLFTGTAAAEAEGGGKKGGKKKGSSFQTVSALFRENLNKLMTNLRTHSPHFVRSIIPNETKTPGAMEHELVLHQLRCNGVLEGIRICRKGFPSRILYADFKQRYKVLNASAIPEGQFIDSKKASEKLLGSIDVDHTQYKFGHTKVFFKAGLLGLLEEMRDDKLAQLITRTQAMCRGFLARVEYKKMVERRESIFCIQYNIRAFMNVKHWPWMKLYFKIKPLLKSAETEKEMANMKEEFEKTKESLAKAEAKEKELEEKMVALMQEKNDLQLQVQAEADSLADAEERCDQLIKTKIQLEAKIKEVTERAEDEEEINAELTAKKRKLEDECSELKKDIDDLELTLAKVEKEKHATENKVKNLTEEMAGLDETIAKLTKEKKALQEAHQQTLDDLQAEEDKVNTLTKAKTKLEQQVDDLEGSLEQEKKIRMDLERAKRKLEGDLKLAQESTMDIENDKQQLDEKLKKKEFEMSNLQSKIEDEQALAMQLQKKIKELQARIEELEEEIEAERASRAKAEKQRSDLSRELEEISERLEEAGGATSAQIEMNKKREAEFQKMRRDLEEATLQHEATAATLRKKHADSVAELGEQIDNLQRVKQKLEKEKSELKMEIDDLASNMETVSKAKGNLEKMCRTLEDQVSELKTKEEEHQRLINDLSAQRARLQTESGEFSRQLDEKDSLVSQLSRGKQAFTQQIEELKRQLEEEIKAKSALAHALQSARHDCDLLREQYEEEQEAKAELQRAMSKANSEVAQWRTKYETDAIQRTEELEEAKKKLAQRLQDAEEHVEAVNAKCASLEKTKQRLQNEVEDLMIDVERTNAACAALDKKQRNFDKILAEWKHKYEETHAELEASQKESRSLSTEVFKVKNAYEESLDQLETLKRENKNLQQEISDLTEQIAEGGKRIHELEKVKKQVEQEKSELQAALEEAEASLEHEEGKILRIQLELNQVKSEIDRKIAEKDEEIDQLKRNHIRVVESMQSTLDAEIRSRNDAIRIKKKMEGDLNEMEIQLNHANRMAAEALRNYRNTQGILKDTQLHLDDALRGQEDLKEQLAMVERRANLLQAEIEELRATLEQTERSRKVAEQELLDASERVQLLHTQNTSLINTKKKLETDISQIQGEMEDIVQEARNAEEKAKKAITDAAMMAEELKKEQDTSAHLERMKKNMEQTVKDLQHRLDEAEQLALKGGKKQIQKLEARVRELEAEVESEQKRNVEAVKGLRKHERRVKELTYQTEEDRKNVLRLQDLVDKLQAKVKSYKRQAEEAEEQCNINLSKFRKLQHELEEAEERADIAESQVNKLRVKSREVHTKVISEE";
	Index<String<AminoAcid>, IndexEsa<> > esaIndex(protein);
	Finder<Index<String<AminoAcid>, IndexEsa<> > > esaFinder(esaIndex);

	while (find(esaFinder, "MRKDADM"))
	{
		std::cout << position(esaFinder) << std::endl;
	}

	Index<String<AminoAcid>, FMIndex<> > fmIndex(protein);
	Finder<Index<String<AminoAcid>, FMIndex<> > > fmFinder(fmIndex);

	while (find(fmFinder, "MRKDADM"))
	{
		std::cout << position(fmFinder) << std::endl;
	}

	return 0;
}